define(function(e,t,o){"use strict";function g(e,t){localStorage.setItem(e,t)}function h(){if(s.hasOwnProperty("getAllPanelIDs")||s.hasOwnProperty("getPanelForID")){var e=s.getAllPanelIDs();i=[],e.forEach(function(e){var t=s.getPanelForID(e);t&&t.isVisible()&&(t.hide(),i.push(e))})}}function w(){if(s.hasOwnProperty("getPanelForID")){var e=i;e.forEach(function(e){var t=s.getPanelForID(e);t&&t.show()}),i=[]}}function m(){$(".main-view .content").each(function(e,t){var o=~~$(t).css("right").replace(/\D/g,""),r=f.outerWidth(!0);$(t).css("right",o+r),$($(".main-view")[0].lastChild).css("right",r)})}function b(){$(".main-view .content").each(function(e,t){var o=~~$(t).css("right").replace(/\D/g,""),r=f.outerWidth(!0);$(t).css("right",Math.max(o-r,0)),$($(".main-view")[0].lastChild).css("right",0)})}function p(){g(l,!1),b(),f.addClass("cw-forced-hidden"),$("#cw-toolbar-btn").attr("title","Show Toolbar").html("&laquo;"),h()}function v(){g(l,!0),f.removeClass("cw-forced-hidden"),m(),$("#cw-toolbar-btn").attr("title","Hide Toolbar").html("&raquo;"),w()}function P(){var e=localStorage.getItem(l);null===e?g(l,!0):"true"===e?$("#cw-toolbar-btn").attr("title","Hide Toolbar").html("&raquo;"):p()}function k(){}function M(){var e=$(r.createElement("div")).addClass("cw-toolbar-btn").attr({id:"cw-toolbar-btn",title:"Hide Toolbar"}).click(function(e){e.preventDefault(),f.hasClass("cw-forced-hidden")?v():p()}).html("&raquo;");u.addClass("cw-status-button"),u.append(e)}var r=window.document,n=brackets.getModule("preferences/PreferencesManager"),a=n.getExtensionPrefs("custom.work"),s=brackets.getModule("view/WorkspaceManager"),i=[],c="showButtonForToolbar",l="custom.work.show.toolbar",f=$("#main-toolbar"),u=$("#status-bar"),d=!1;a.definePreference(c,"boolean",!1,{description:"creates a button in status bar positioned to the right for shows/hides the toolbar"}).on("change",function(){a.get(c)?d||(d=!0,f.addClass("cw-toolbar"),M(),P()):d&&(d=!1,f.removeClass("cw-toolbar"),$("#cw-toolbar-btn").remove(),u.removeClass("cw-status-button"),k())})});